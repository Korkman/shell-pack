# Pierre's tmux.conf

# make it easy to reload the config (CTRL+r)
bind r source-file ~/.tmux.conf \; display "Config reloaded!"

# Intuitive window splitting
bind | split-window -h # left/right, default: %
bind - split-window -v # top/bottom, default: "

# Large history
set -g history-limit 10000

# Mouse support (tmux >= 2.1)
set -g mouse on
# encourage user to use client-side clipboard to avoid confusion:
# disable mouse copy-mode (if you have a mouse, use shift to copy & paste)
unbind    -T root   MouseDown3Pane
unbind    -T root   MouseDrag1Pane
unbind    -T root   WheelUpPane   

# Display messages longer
set -g display-time 5000

# copy and paste

# vi keys are best (most intuitive) for copy and paste
set -g mode-keys vi

# enter copy mode, tmux default: [
bind PageUp copy-mode \; display-message 'Entered copy-mode, use PgUp/PgDn to scroll, press q or enter to leave'
bind Escape copy-mode \; display-message 'Entered copy-mode, use PgUp/PgDn to scroll, press q or enter to leave'
# add C-a v for paste (unmodified)
bind v paste-buffer -r

# shift window number +1 / -1 (use . to set a specific number)
bind Left swap-window -t -1
bind Right swap-window -t +1

# broadcast input to all panes
bind B set-window-option synchronize-panes \
\; display-message "synchronize-panes is now #{?pane_synchronized,on,off}" \
\; setw pane-border-style "bg=colour226,fg=colour16" \
\; setw pane-active-border-style "bg=colour226,fg=colour16" \
\; setw pane-border-format '#{pane_index} #T' \
\; setw pane-border-status top

# set very low escape time (ms)
# feels responsive, should not cause problems in our networks
set -g escape-time 2

# Full color support
set -g default-terminal screen-256color

# automatic rename of window name to active pane title
set-window-option -g automatic-rename on
set-window-option -g automatic-rename-format '#T'

# gnu screen compatibility
set -g prefix C-a           # ctrl-a command prefix: screen compat
set -g prefix2 C-b          # ctrl-b command prefix: tmux default
bind bspace previous-window # prev window, tmux default: p
bind space next-window      # next window, tmux default: n
bind C-space next-window    # catch accidential ctrl-key press
bind S split-window -v      # split vertical, tmux default: "
bind C-a last-window        # last window toggle, tmux default: l
bind a send-prefix          # jump to beginning of line in bash, tmux default: different prefix C-b
bind Q break-pane           # make split region a dedicated window, tmux default: !
# kill current pane, tmux default: x
bind k confirm-before -p "Kill pane? (y/N)" kill-pane
# tab to move to next pane, tmux default: o
bind tab select-pane -t:.+
# kill all windows, screen-like + Shift-K
bind K confirm-before -p "Kill all windows and exit? (y/N)" kill-session
bind '\' confirm-before -p "Kill all windows and exit? (y/N)" kill-session
# show window number and name
bind N display-message "This is window #I (#W). C-a . changes index, C-a A changes name."
# rename window, tmux default: ,
# added: disable renaming to make new name permanent
bind A command-prompt -I "#W" "rename-window '%%'" \; set-window-option allow-rename off

# Pass thru window title set by shell
set -g set-titles on
set -g set-titles-string '#T'

# Allow shell to rename window
set -g allow-rename on

# TODO: Make watch -d highlighting ("standout") clearly visible
# https://gist.github.com/stuartcarnie/818d14647cd1a42a4fbbcd689675b8c0

# make ctrl-arrow work in mc
# make shift-arrow work in mc
set-window-option -g xterm-keys on

# make client-side scrollbuffers work
# adding xterm*:smcup@:rmcup@,rxvt*:smcup@:rmcup@,xs:smcup@:rmcup@ to default
set -g terminal-overrides 'xterm*:smcup@:rmcup@,rxvt*:smcup@:rmcup@,xs:smcup@:rmcup@,*88col*:colors=88,*256col*:colors=256,xterm*:XT:Ms=\E]52;%p1%s;%p2%s\007:Cc=\E]12;%p1%s\007:Cr=\E]112\007:Cs=\E[%p1%d q:Csr=\E[2 q,screen*:XT'

# Status line colors
set -g status on
# blue color scheme for stage systems
set -g status-style bg=colour26,fg=brightwhite
set-window-option -g window-status-current-style bg=brightwhite,fg=blue

# Refresh interval for the status, default: 15
#set -g status-interval 15

# show host, session on the left
set -g status-left-length 27
set -g status-left '#{=20:host_short}/#S'

# show load, better clock on the right
set -g status-right-length 45
set -g status-right '#(cut -d " " -f -3 /proc/loadavg) | %H:%M %Y-%m-%d'

# center window list
set -g status-justify centre
